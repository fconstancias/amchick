function FRError(n){var t=this;return t.name="Generic Error",t.message="Unknown",n&&typeof n=="string"&&(this.message=n),n&&typeof n=="object"&&(n.name&&(t.name=n.name),n.Name&&(t.name=n.Name),n.message&&(t.message=n.message),n.Message&&(t.message=n.Message),FRConfiguration.Environment=="Development"&&((n.ExceptionType||n.StackTrace)&&(t.message=t.message+"<br>"),n.ExceptionType&&(t.message=t.message+n.ExceptionType+" "),n.StackTrace&&(t.message=t.message+n.StackTrace+" "),(n.className||n.methodName)&&(t.message=t.message+"<br>"),n.className&&(t.message=t.message+n.className+" "),n.methodName&&(t.message=t.message+n.methodName+" "))),FRLog.error(t.name+": "+t.message),t}function getFrontiersApi(n,t){if($.browser&&$.browser.msie&&parseInt($.browser.version,10)<10&&window.XDomainRequest){var i=new window.XDomainRequest;i.open("get",n);i.onload=function(){t(eval("json = "+i.responseText))};i.onerror=function(){return};i.ontimeout=function(){return};i.onprogress=function(){return};setTimeout(function(){i.send()},0)}else $.getJSON(n,function(n){t(n)})}function ucfirst(n){return n.charAt(0).toUpperCase()+n.slice(1)}function killWhiteSpace(n){return n.replace(/\s/g,"")}function getProfileUrl(n,t){return siteUrl+"/Community/WhosWhoActivity.aspx?sname="+t+"&UID="+n}function showLoadingStatus(n,t){n?$("#"+t).show():$("#"+t).hide()}function getTrimmedFullName(n){if(n!=null)return n.length>40&&(n=n.substring(0,39)+"..."),n}function getTimeNow(){var n=new Date;return n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()+" "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()}function getTimezoneOffsetInHours(){var n=(new Date).getTimezoneOffset()/-60;return(n%1==0||n==0)&&(n=n+".0"),n}function return2br(n){return n.replace(/(\r\n|[\r\n])/g,"<br/>")}function Create2DArray(n){for(var i=[],t=0;t<n;t++)i[t]=[];return i}function StringBuilder(){this._array=[];this._index=0;this.append.apply(this,arguments)}function htmlEntities(n){return n.replace(/[<>]/g,function(n){return n==="<"?"&lt;":"&gt;"})}function formatTextContent(n){var t=n.replace(/\n/g,"<br/>");return t=htmlEntities(t),$("<div/>").html(t).text()}function getQueryString(n){var i=window.location.search.substring(1),r,t,u;if(!i||!i.length)return"";for(r=i.split("&"),t=0;t<r.length;t++)if(u=r[t].split("="),u[0]==n)return u[1]}function getHashTag(n){var r=window.location.hash.substring(1),i,t;if(!r||!r.length)return"";for(i=r.split("/"),t=0;t<i.length;t++)if(i[t]==n)return i[t+1]}function makeLinks(n){var t,i,r,u;return i=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,t=n.replace(i,'<a href="$1" target="_blank">$1<\/a>'),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim,t=t.replace(r,'$1<a href="http://$2" target="_blank">$2<\/a>'),u=/(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/gim,t.replace(u,'<a href="mailto:$1">$1<\/a>')}function removeHTMLTags(n){return n!=""?n.replace(/(<([^>]+)>)/ig,""):""}function removeWhiteSpaces(n){return n!=""?n.replace(/&nbsp;/gi,"").replace(/\/n/g,""):""}function showUserImage(n){FRSocialActivity.showUserImage(n)}function showUserImageOnEdit(n){FRSocialActivity.showUserImageOnEdit(n)}function showUserImageOnAdd(n){FRSocialActivity.showUserImageOnAdd(n)}function hideUserImage(n){FRSocialActivity.hideUserImage(n)}function showAllUsersFeedActivityPopup(n,t,i){FRSocialActivity.showAllUsersFeedActivityPopup(n,t,i)}function hideAllUsersFeedActivityPopup(n,t,i){FRSocialActivity.hideAllUsersFeedActivityPopup(n,t,i)}function AddComments(n){FRSocialActivity.comment.add(n)}function EditComments(n,t){FRSocialActivity.comment.edit(n,t)}function GetFormattedCommentDate(n){return FRSocialActivity.getFormattedCommentDate(n)}function GetFormattedCommentDeletedDate(n){return FRSocialActivity.getFormattedCommentDeletedDate(n)}function inherits(n,t){function i(){}i.prototype=t.prototype;n.superClass_=t.prototype;n.prototype=new i;n.prototype.constructor=n}function MarkerLabel_(n,t){this.marker_=n;this.handCursorURL_=n.handCursorURL;this.labelDiv_=document.createElement("div");this.labelDiv_.style.cssText="position: absolute; overflow: hidden;";this.eventDiv_=document.createElement("div");this.eventDiv_.style.cssText=this.labelDiv_.style.cssText;this.eventDiv_.setAttribute("onselectstart","return false;");this.eventDiv_.setAttribute("ondragstart","return false;");this.crossDiv_=MarkerLabel_.getSharedCross(t)}function MarkerWithLabel(n){n=n||{};n.labelContent=n.labelContent||"";n.labelAnchor=n.labelAnchor||new google.maps.Point(0,0);n.labelClass=n.labelClass||"markerLabels";n.labelStyle=n.labelStyle||{};n.labelInBackground=n.labelInBackground||!1;typeof n.labelVisible=="undefined"&&(n.labelVisible=!0);typeof n.raiseOnDrag=="undefined"&&(n.raiseOnDrag=!0);typeof n.clickable=="undefined"&&(n.clickable=!0);typeof n.draggable=="undefined"&&(n.draggable=!1);typeof n.optimized=="undefined"&&(n.optimized=!1);n.crossImage=n.crossImage||"http"+(document.location.protocol==="https:"?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png";n.handCursor=n.handCursor||"http"+(document.location.protocol==="https:"?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur";n.optimized=!1;this.label=new MarkerLabel_(this,n.crossImage,n.handCursor);google.maps.Marker.apply(this,arguments)}var FRAlert=function(){var n=this,t='<li class="alert"><a class="close bypassSecurityPopup" href="javascript:void(0)">Ã—<\/a><div class="icon"><\/div><div class="content"><\/div><\/li>';n.alert=$(t);n.alert.on("click",".close",function(){n.destroy();$(document).trigger("afterClose.alert")});return n},FRLog,FRSafe,FRTemplate,FRNetworkUserFollow;FRAlert.prototype.init=function(n){var t=this;n&&(typeof n=="string"&&t.alert.find(".content").html(n),typeof n=="object"&&t.alert.find(".content").html(JSON.stringify(n)));n&&n.content&&t.alert.find(".content").html(n.content);n&&n.type&&t.alert.addClass(n.type)};FRAlert.prototype.show=function(){var n=this;n.alert.css({top:"-100px"});$("#alerts").prepend(n.alert);n.alert.animate({top:0},"slow")};FRAlert.prototype.destroy=function(){var n=this;n.alert.remove()};FRAlert.prototype.basic=function(n){var t=this;t.init(n);t.alert.find(".icon").html('<i class="fr-icon-v2-info-circled"><\/i>');t.show()};FRAlert.prototype.success=function(n){var t=this;t.init(n);t.alert.addClass("success");t.alert.find(".icon").html('<i class="fr-icon-v2-ok-circle"><\/i>');t.show();t.alert.delay(6e3).fadeOut(500,function(){$(this).remove()})};FRAlert.prototype.warning=function(n){var t=this;t.init(n);t.alert.addClass("warning");t.alert.find(".icon").html('<i class="fr-icon-v2-attention-circled"><\/i>');t.show()};FRAlert.prototype.error=function(n){var t=this;t.init(n);t.alert.addClass("error");t.alert.find(".icon").html('<i class="fr-icon-v2-cancel-circle"><\/i>');t.show()};$(document).ready(function(){$(document).on("alert.success",function(n,t){var i=new FRAlert;i.success(t)});$(document).on("alert.error",function(n,t){var i=new FRAlert;i.error(t)});$(document).on("alert.basic",function(n,t){var i=new FRAlert;i.basic(t)});$(document).on("alert.warning",function(n,t){var i=new FRAlert;i.warning(t)})});FRLog=function(){function s(){f||$(".ibar .loading").show()}function h(){f||$(".ibar .loading").hide()}function e(){f=!0;$(".ibar .loading").show();$(".ibar .loading").html('<i class="fr-icon-v2-attention-circled"><\/i>')}function o(){}function n(n,f){if(FRConfiguration.Environment=="Development"&&(u.push(f),o(n,f)),n=="log"&&console.log(f),n=="basic"){var s=new FRAlert;s.basic(f)}n=="success"&&(t&&t.destroy(),t=new FRAlert,t.success(f));n=="warning"&&(e(),i&&i.destroy(),i=new FRAlert,i.warning(f));n=="error"&&(e(),r&&r.destroy(),r=new FRAlert,r.error(f))}function c(){console.log("FRLog | This is the full stack...");for(var n=0;n<u.length;n++)console.log(u[n])}var u=[],f=!1,t,i,r;return $(document).ajaxSend(function(){s()}),$(document).ajaxStop(function(){h()}),$(document).ajaxError(function(n,t,i,r){r=="abort"||r=="Abort"||e()}),{print:c,notify:o,basic:function(t){n("basic",t)},success:function(t){n("success",t)},warning:function(t){n("warning",t)},error:function(t){n("error",t)},debug:function(t){FRConfiguration.Environment=="Development"&&(console.log(t),n("basic",t))}}}(),function(){window.d=FRLog.debug}();FRError.prototype=new Error;FRError.prototype.constructor=FRError;$(document).ajaxError(function(n,t,i,r){if(t&&t.responseText){var u=$.parseJSON(t.responseText);throw new FRError({name:"Server Error",message:u.Message,ExceptionType:u.ExceptionType,StackTrace:u.StackTrace});}else if(r=="timeout"||r=="Timeout")throw new FRError({name:"Connection Error",message:"Timeout"});else r=="abort"||r=="Abort"||FRConfiguration.Environment=="Development"});window.onerror=function(){return FRConfiguration.Environment=="Development"?!1:FRConfiguration.Environment=="Test"?!1:FRConfiguration.Environment=="Live"?!0:void 0};FRSafe=function(){return{boolean:function(n){return n=="True"?!0:!1}}}();$.extend({getFrontiersApi:function(n,t){return getFrontiersApi(n,t)},getHTML:function(n,t){return jQuery.get(n,undefined,t,"html")},getText:function(n,t){return jQuery.get(n,undefined,t,"text")}});$.extend({ajaxCrossDomain:function(n){var t=$.extend({url:"",data:{},type:"GET",success:function(){}},n),r,i;t.data&&t.data.cookies&&$.isArray(t.data.cookies)&&t.data.cookies.length&&(r=FRCookie.getAll(t.data.cookies),t.data.cookies=FRBase64.encode(r));$.browser&&$.browser.msie&&parseInt($.browser.version,10)<10&&window.XDomainRequest?(document.location.protocol=="http:"&&(t.url=t.url.replace("https:","http:")),i=new window.XDomainRequest,i.open(t.type,t.url),i.onload=function(){i.responseText&&i.responseText.length&&t.success(eval("json = "+i.responseText))},i.onerror=function(){return},i.ontimeout=function(){return},i.onprogress=function(){return},setTimeout(function(){i.send(JSON.stringify(t.data))},0)):$.ajax({dataType:"json",url:t.url,data:t.data,type:t.type}).done(function(n){t.success(n)})}}),function(n){var t={check:function(){var n=this.first();return n.data("disabled")?!0:(n.data("disabled",!0),!1)},clear:function(){return this.data("disabled",!1)}};n.fn.checkDuplicateEvent=function(n){return t[n]?t[n].apply(this):t.check.apply(this)}}(jQuery);StringBuilder.prototype.append=function(){for(var n=0;n<arguments.length;n++)this._array[this._index]=arguments[n],this._index++};StringBuilder.prototype.toString=function(){return this._array.join("")};$.fn.justtext=function(){return $(this).clone().children().remove().end().text()};$.fn.hasAttr=function(n){return this.attr(n)!==undefined};$.fn.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.leftTrim=function(){return this.replace(/^\s+/,"")};String.prototype.truncate=function(n){var t=this.toString();return t?t.length<=n?t:(t=t.substring(0,n),t.indexOf(" ")>0?t.replace(/\W*\s(\S)*$/,"..."):t+"..."):""};String.prototype.truncateKeywords=function(n,t){var r=this.length>n,i=r?this.substr(0,n-1):this;return i=t&&r?i.substr(0,i.lastIndexOf(" ")):i,r?i+"&nbsp;&hellip;":i};FRTemplate=function(){function i(i,r){if(!n||!n.length)return"";var u=t(i),f=_.template(u);return f(r)}function t(t){return n.map(function(){if(this.id==t)return $(this).html()}).get(0)}var n=$("#divTemplates").children();return{get:function(n){return t(n)},bind:function(n,t){return i(n,t)}}}();$(document).ready(function(){$(document).on("ui.refresh",function(){$("select:not(select[multiple]).pretty").each(function(){$(this).hasClass("is-pretty")||($(this).select2({placeholder:"Select",width:"element"}),$(this).addClass("is-pretty"),$(this).css("display","none"))});$(".frUIMouse").each(function(){$(this).hasClass("is-ui")||($(this).mouseover(function(){$(this).addClass("open")}),$(this).mouseout(function(){$(this).removeClass("open")}),$(this).addClass("is-ui"))});$(".frUIAccordion").each(function(){var n=$(this);n.hasClass("is-ui")||(n.children(".header").click(function(){n.children(".content").toggleClass("hide");n.children(".content").hasClass("hide")?(n.children(".header").find("i").removeClass("rounded-arrow-down"),n.children(".header").find("i").addClass("rounded-arrow-right")):(n.children(".header").find("i").removeClass("rounded-arrow-right"),n.children(".header").find("i").addClass("rounded-arrow-down"))}),$(this).addClass("is-ui"))});$(".frUIToolTip").each(function(){$(this).hasClass("is-ui")||($(this).tooltip(),$(this).addClass("is-ui"))});$(".frUIResizeTextArea").each(function(){$(this).hasClass("is-ui")||($(this).autosize(),$(this).addClass("is-ui animated-resize"))});$(".frUIFitString").each(function(){if(!$(this).hasClass("is-ui")){var t=$(this),i=t.height(),n=t.children("span");for($(this).data("frUIFitString",$(n).text());$(n).outerHeight()>i;)$(n).text(function(n,t){return t.replace(/\W*\s(\S)*$/,"...")});$(this).addClass("is-ui")}});$(".frUIFitStringWithTooltip").each(function(){var r,n,u,i,t,f;if(!$(this).hasClass("is-ui")){if(r=$(this),n=r.children("span"),n.text(n.data("original-title")),u=n.html(),i=n.html().length,i>0)while(parseInt(n.height())>parseInt(r.css("height")))i--,t=u.substr(0,i-1),t=t.substr(0,t.lastIndexOf(" ")),f=t+"&nbsp;&hellip;",n.html(f),n.tooltip({placement:"bottom",template:'<div class="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner keywordTooltip"><\/div><\/div>'});$(this).addClass("is-ui")}});$(".input-prepend input, .input-append input").each(function(){$(this).hasClass("is-ui")||($(this).focus(function(){$(this).parent().find(".add-on").addClass("selected")}),$(this).blur(function(){$(this).parent().find(".add-on").removeClass("selected")}),$(this).addClass("is-ui"))})})});$(document).ready(function(){$(document).on("string.refresh",function(){$(".frUIStringFit").each(function(){var i,n,r,t,u;if(!$(this).hasClass("is-ui")){if(i=$(this),n=i.children("span"),$(this).data("frUIStringFit",$(n).html()),r=$(n).html(),t=$(n).html().length,t>0)while(parseInt($(n).height())>parseInt(i.css("height")))t--,u=r.truncateKeywords(t,!0),$(n).html(u);$(this).addClass("is-ui")}})})});$.fn.extend({frUIToggle:function(){return $(this).toggleClass("hide"),$(this)}});$.fn.extend({frUIToggleActivityBoxFromBelow:function(){var t=$("#activityBoxAnimationEnd"),n;return $(this).hasClass("hide")?($("div.element.review.activityBox").addClass("hide"),$(this).css({x:"0px",y:"400px",scale:.1,opacity:.4}),$(this).removeClass("hide"),$(this).transition({x:"0px",y:"0px",scale:1,opacity:1},800,"ease"),n=t.offset().top-36-($(window).height()-$(this).outerHeight(!1))/2+$(window).height()/1e3*75,$(window).height()<$(this).outerHeight(!1)+72&&(n=t.offset().top-82),$("html, body").animate({scrollTop:n},800)):$(this).addClass("hide"),$(this)}});$(document).ajaxComplete(function(){$(document).trigger("ui.refresh")});$(document).ready(function(){$(document).on("ui.lock",function(){var t=$("body"),n;t.find("#overlay").length||(n=$('<div id="overlay"><div class="loading"><div class="icon"><span class="fr-icon-v2-spin1 animate-spin"><\/span><\/div><div class="caption"><span>Please wait...<\/span><\/div><\/div><\/div>'),t.prepend(n),setTimeout(function(){n.parent().length&&(n.remove(),FRLog.warning("An error occoured. If the problem persists, please contact the Frontiers support."))},6e4))});$(document).on("ui.unlock",function(){$("body").find("#overlay").remove()})});$(function(){var n=BrowserDetect.init();if(n.browser=="Explorer"){$("body").addClass("ie");$(document).on("ui.refresh",function(){$("input[type='text']:disabled, textarea:disabled").each(function(){var n=$(this);n.removeAttr("disabled");n.prop("readonly",!0)});$("input, textarea").each(function(){var n=$(this),t;(n.val()==""||n.val()==null)&&(t=n.attr("placeholder"),n.val(t));n.attr("placeholder")!=""&&$(this).val()==$(this).attr("placeholder")&&n.addClass("hasPlaceholder");$("input, textarea").focus(function(){$(this).attr("placeholder")!=""&&$(this).val()==$(this).attr("placeholder")&&$(this).val("").removeClass("hasPlaceholder")}).blur(function(){$(this).attr("placeholder")!=""&&($(this).val()==""||$(this).val()==$(this).attr("placeholder"))&&$(this).val($(this).attr("placeholder")).addClass("hasPlaceholder")});$("form").submit(function(){$(this).find(".hasPlaceholder").each(function(){$(this).val("")})})})})}});var FRTracking=function(){function n(n,t,i,r,u){if(window._gaq){r!="undefined"&&u!="undefined";return}window.ga||(d({category:n,action:t,opt_label:i,opt_value:r,opt_noninteraction:u}),FRLog.warning("Google Analytics is not active on this page!"))}$(document).on("click","a[data-tracking]",function(){var t=$(this).data("tracking");n(t.category,t.action,t.label)});var t=function(n,t,i,r){ga.hasOwnProperty("loaded")&&ga.loaded===!0||(document.location=r)};return{event:n,trackOutboundLink:t}}(),BrowserDetect={init:function(){return this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS",this},searchString:function(n){for(var i,r,t=0;t<n.length;t++)if(i=n[t].string,r=n[t].prop,this.versionSearchString=n[t].versionSearch||n[t].identity,i){if(i.indexOf(n[t].subString)!=-1)return n[t].identity}else if(r)return n[t].identity},searchVersion:function(n){var t=n.indexOf(this.versionSearchString);if(t!=-1)return parseFloat(n.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},FRCookie=function(){function n(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i);u=JSON.stringify(t)+(i==null?"":"; expires="+r.toUTCString());document.cookie=n+"="+u}function t(n){var t=document.cookie,i=t.indexOf(" "+n+"="),r;return i==-1&&(i=t.indexOf(n+"=")),i==-1?t=null:(i=t.indexOf("=",i)+1,r=t.indexOf(";",i),r==-1&&(r=t.length),t=t.substring(i,r)),t}function i(n){if(n&&n.length){var t=[];return $(n).each(function(n,i){var r=FRCookie.get(i);r&&r.length&&t.push(i+"="+r)}),t.join("; ")}}return{set:n,get:t,getAll:i}}(),FRBase64=function(){function t(n){var i,r,t;for(n=n.replace(/\r\n/g,"\n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i}function i(n){for(var r="",t=0,i=c1=c2=0;t<n.length;)i=n.charCodeAt(t),i<128?(r+=String.fromCharCode(i),t++):i>191&&i<224?(c2=n.charCodeAt(t+1),r+=String.fromCharCode((i&31)<<6|c2&63),t+=2):(c2=n.charCodeAt(t+1),c3=n.charCodeAt(t+2),r+=String.fromCharCode((i&15)<<12|(c2&63)<<6|c3&63),t+=3);return r}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(i){var o="",s,r,u,c,l,h,f,e=0;for(i=t(i);e<i.length;)s=i.charCodeAt(e++),r=i.charCodeAt(e++),u=i.charCodeAt(e++),c=s>>2,l=(s&3)<<4|r>>4,h=(r&15)<<2|u>>6,f=u&63,isNaN(r)?h=f=64:isNaN(u)&&(f=64),o=o+n.charAt(c)+n.charAt(l)+n.charAt(h)+n.charAt(f);return o},decode:function(t){var r="",s,h,c,l,e,f,o,u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)l=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),o=n.indexOf(t.charAt(u++)),s=l<<2|e>>4,h=(e&15)<<4|f>>2,c=(f&3)<<6|o,r=r+String.fromCharCode(s),f!=64&&(r=r+String.fromCharCode(h)),o!=64&&(r=r+String.fromCharCode(c));return i(r)}}}(),FRSocialActivity=function(){var r=$(".page-container"),f=r.find(".right-container"),n=r.find(".social-feed"),i=r.find(".comment-list"),e=getTimeNow(),o=getTimezoneOffsetInHours(),s=window.FRConfiguration.SharepointWebsiteUrl.replace("http://",""),t=function(){function v(){$(document).on("focus",".setfocus",function(){$(this).removeClass("grey_70").addClass("grey_90");this.value==this.defaultValue&&(this.value="");this.value!=this.defaultValue&&this.select()});$(document).on("blur",".setfocus",function(){$.trim(this.value).length||($(this).removeClass("grey_90").addClass("grey_70"),this.value=this.defaultValue?this.defaultValue:"")});$(document).click(function(i){var r=i.target?$(i.target):$(i.srcElement),u,s,h;r.parents().andSelf().is(".bubbleInfo,.fontnormal trigger")?(s=$("table.popup").filter(function(){return $(this).css("display")==="block"}),s.length>1&&(h=$("table.popup").filter(function(){return $(this).css("display")==="block"&&$(this).css("opacity")==1}),h.css("display","none"))):(u=$("table.popup"),t&&clearTimeout(t),t=setTimeout(function(){t=null;u.animate({top:"-="+o+"px",opacity:0},e,"swing",function(){f=!1;u.css("display","none")})},200),setTimeout(function(){u.css("filter")!="none"&&u.css("opacity")>0&&u.css({opacity:"0",filter:"alpha(opacity = 0)",top:"17px"})},300));(r.is(n.find("a.showComment"))||r.is(n.find("a.showComment span"))||r.is(n.find("a.btmArrow span")))&&(r.parents("div.commentsWrapper").children("div.moreComments").css("display")=="none"?(r.is("a.showComment span.float_right")?r.removeClass("downArrow").addClass("upArrow"):r.parents("a.showComment").children("span.float_right").removeClass("downArrow").addClass("upArrow"),r.parents("div.CommentsHolder").children("div.commentBox:last").children("div.wrapper").children("div.content").children("ul.toolbar").children("li.float_right").html("<a href='javascript:void(0);' class='fontnormal btmArrow'><span class='upArrow float_right'><\/span><\/a>")):(r.is("a.showComment span.float_right")?r.removeClass("upArrow").addClass("downArrow"):r.parents("a.showComment").children("span.float_right").removeClass("upArrow").addClass("downArrow"),r.parent().is("a.btmArrow")?(r.parents("div.CommentsHolder").children("div.commentsWrapper").find("a.showComment span.float_right").removeClass("upArrow").addClass("downArrow"),r.parents("div.CommentsHolder").children("div.commentsWrapper").children("div.moreComments").toggle("slow"),r.parents("div.CommentsHolder").children("div.commentsWrapper").children("div.commentBox").children("div.float_left").children("a.showComment").focus(),r.parents("div.CommentsHolder").children("div.commentBox:last").children("div.wrapper").children("div.content").children("ul.toolbar").children("li.float_right").html("")):(r.is("a.showComment span.float_right")?r.removeClass("upArrow").addClass("downArrow"):r.parents("a.showComment").children("span.float_right").removeClass("upArrow").addClass("downArrow"),r.parents("div.CommentsHolder").children("div.commentBox:last").children("div.wrapper").children("div.content").children("ul.toolbar").children("li.float_right").html(""))),r.parents("div.commentsWrapper").children("div.moreComments").toggle("slow"),r.parents("div.CommentsHolder").children("div.commentsWrapper").children("div.commentBox").children("div.float_left").children("a.showComment").focus())})}function l(){$.getJSON("/api/articles-comment/"+window.FRSocial.entityId+"/getcomments").done(function(n){y(n)}).fail(function(){throw new FRError({className:"FRSocialActivityBox",methodName:"populateArticleComments",message:"Failed to get the comments"});}).always(function(){i.find(".loading-wrapper").remove()})}function y(t){if(i.find(".container-comments").data("loggedin-user-info",t.LoggedInUserInfo),i.find("#add-comment-form").show(),t){var u=FRConfiguration.IsPreview.toLowerCase()==="true"?!0:FRConfiguration.IsCommentVisible.toLowerCase()==="true"?!0:!1,r=u?FRTemplate.bind("template-article-comments",{journalComments:t}):FRTemplate.bind("template-article-comments-warning");r.length&&(i.find(".container-comments").html(r),p(),k(),n.find("textarea").addClass("frUIResizeTextArea comment-textarea").removeClass("w605 h15a fs11"),$(document).trigger("ui.refresh"))}}function p(){i.find("a[data-comment-id]").each(function(){var n=$(this);n.data("id",n.data("comment-id"));n.removeAttr("data-comment-id")})}function w(n){var t=moment(n).format("h:mm A, DD MMMM YYYY"),i=new Date,r=moment(i).get("year"),u=moment(i).get("month"),f=moment(i).get("date"),e=moment(n).get("year"),o=moment(n).get("month"),s=moment(n).get("date");return f-s==1&&o==u&&e==r?t="Yesterday at "+moment(n).format("h:mm A"):s==f&&o==u&&e==r&&(t="Today at "+moment(n).format("h:mm A")),t}function b(n){return moment(n).format("h:mm A, DD MMMM YYYY")}function k(){if($("div.bubbleInfo").length>0){var n=300;$("div.bubbleInfo").each(function(){$(this).css("zIndex",n);n-=1})}}function d(n,i,r){var l,u;return h?!1:(h=!0,o=10,e=250,a=200,c=27,t=null,s=!1,f=!1,l=n+"_"+i+"_"+r,$("#pAllUsers_"+l).text().indexOf(",...")!=-1)?(u=$("#tblAllUsers_"+l).css("opacity",0),t&&clearTimeout(t),s||f)?!1:(s=!0,u.css({top:c,left:2,display:"block"}).animate({top:"-="+o+"px",opacity:1},e,"swing",function(){s=!1;f=!0}),setTimeout(function(){u.css("filter")!="none"&&u.css("opacity")<1&&u.css({opacity:"1",filter:"alpha(opacity = 100)",top:"17px"});h=!1},300),!1):(h=!1,!1)}function g(n,i,r){var u=$("#tblAllUsers_"+n+"_"+i+"_"+r);return t&&clearTimeout(t),t=setTimeout(function(){t=null;u.animate({top:"-="+o+"px",opacity:0},e,"swing",function(){f=!1;u.css("display","none")})},200),setTimeout(function(){u.css("filter")!="none"&&u.css("opacity")>0&&u.css({opacity:"0",filter:"alpha(opacity = 0)",top:"17px"})},300),!1}function nt(){if($(".modal.login-modal").length){$(".modal.login-modal").modal("show");return}var n=window.FRConfiguration.SharepointWebsiteUrl+"/Login.aspx?returnurl="+document.location.href,t=$(['<div class="modal login-modal fade" data-backdrop="static">','<div class="modal-dialog">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button>',"<h4>Login Required<\/h4>","<\/div>",'<div class="modal-body">',"<p>This action requires you to be registered with Frontiers and logged in. To register or login click <a href="+n+">here.<\/a> <\/p>","<\/div>",'<div class="modal-footer">','<button type="button" class="btn btn-flat btn-close btn-new-orange" data-dismiss="modal">Close<\/button>',"<\/div>","<\/div>","<\/div>","<\/div>"].join(""));r.append(t);r.find(".modal.login-modal").modal("show")}function tt(n,t){switch(parseInt(n)){case 14:switch(parseInt(t)){case 3:u="ART_SUBJL";break;case 6:u="ART_ACCEPT";break;case 35:u="PUB_EV_ABS";break;case 8:u="ART_PUBLSH";break;case 39:u="ART_PAPEND";break;default:u="ART_SUBJL"}break;case 12:u="RT_LAUNCH"}return u}var e,f,o,c,a,s,t,h=!1,u="",it=r.find("#add-comment-form");return $(function(){if(typeof window.FRSocial=="undefined"||window.FRSocial.itemId<=0){!n||!n.length;return}tt(window.FRSocial.itemId,window.FRSocial.subItemId);v();l()}),{showLoginPopUp:nt,showAllUsersFeedActivityPopup:d,hideAllUsersFeedActivityPopup:g,getFeedTemplateKeyText:function(){return u},populateArticleComments:l,getFormattedCommentDate:w,getFormattedCommentDeletedDate:b}}(),u=function(){function h(){n.find(".write-area").on("focus",function(){$(".profile-thumbnail").show();n.find(".write-area").css("width","603px;")});n.find(".write-area").on("blur",function(){$(".profile-thumbnail").hide();n.find(".write-area").css("width","653px;")});f.on("click",".frontiers-network .comment",function(){var i=$("#txtComment");i&&i.length!=0&&(window.FRSocial.loginUserId==0?t.showLoginPopUp():($("html, body").animate({scrollTop:i.offset().top-100},500),n.find("#txtComment").focus()))});$(document).on("click","a.show-comment ,li.bottom-arrow ",function(){$(".comments-holder .more-comment-box").hasClass("hide")?($(".comments-holder .more-comment-box").show(),$(".comments-holder .more-comment-box").removeClass("hide"),$(".bottom-arrow a").show(),$(".comments-holder .show-comment span").removeClass("down-arrow"),$(".comments-holder .show-comment span").addClass("up-arrow")):($(".comments-holder .more-comment-box").addClass("hide"),$(".comments-holder .more-comment-box").hide(),$(".bottom-arrow a").hide(),$(".comments-holder .show-comment span").removeClass("up-arrow"),$(".comments-holder .show-comment span").addClass("down-arrow"))});i.on("click",".btn-edit-comment",function(){if(window.FRSocial.loginUserId==0)return t.showLoginPopUp(),!1;c($(this))});i.on("click",".edit-comments .btn.btn-add-comment",function(){if(window.FRSocial.loginUserId==0)return t.showLoginPopUp(),!1;l($(this))});i.on("click",".btn-delete-comment",function(){if(window.FRSocial.loginUserId==0)return t.showLoginPopUp(),!1;v($(this))})}function c(n){var i=n.data("id");if(i&&parseInt(i)>0){var t=n.closest(".commentBox"),r=t.find(".comment-body span.comment-text").html(),u=$("<div>").html(r).text(),f=FRTemplate.bind("template-article-edit-comments",{commentText:u,commentId:i});t.find("ul").hide();t.find(".imgHolder a").hide();t.find(".comment-body p").hide();$(f).insertAfter(t.find(".comment-body p"));t.find("textarea").autosize();t.find("textarea").focus()}}function l(n){var v=[FRConfiguration.FrontiersCookieRememberMe,FRConfiguration.FrontiersCookie],r=n.closest(".commentBox"),f=r.find(".edit-comments"),o=r.find(".btn-edit-comment").data("id"),u=i.find(".container-comments").data("loggedin-user-info"),h,c,l,a;if(o&&parseInt(o)>0){if(h=f.find(".txt-comment").val().trim(),c=encodeURIComponent(h),!c.length){f.find(".txt-comment").val("");return}if(!s(h,"","","","","Comments must be less than 4,000 characters. You have entered ","Comment text too long"))return;l=decodeURIComponent(c);f.hide();f.remove();a={CommentId:o,IsDeleted:!1,Comment:l,CommentedUser:{UserId:u.UserId,FullName:u.FullName,Address:u.Address,ProfileUrl:u.ProfileUrl,ThumbnailUrl:u.ThumbnailUrl},IsEditVisible:!0,IsDeleteVisible:!0};$.ajax({url:"/api/articles-comment/"+window.FRSocial.entityId+"/editcomments",type:"POST",data:a,success:function(n){n.IsSuccess?t.populateArticleComments():(r.find(".comment-body").find(".temp-comment").remove(),r.find(".comment-body").find("p").show(),e())},error:function(){r.find(".comment-body").find(".temp-comment").remove();r.find(".comment-body").find("p").show();e()}})}}function a(){var r=i.find(".container-comments").data("loggedin-user-info"),u,f;if(parseInt(window.FRSocial.loginUserId)==0)return t.showLoginPopUp(),!1;if(n.find("#txt_comment").val()=="Write a comment...")return!1;var e=encodeURIComponent(return2br($.trim(n.find("#txt_comment").val()))),o=$.trim(n.find("#txt_comment").val());if(!s(o,"","","","","Comments must be less than 4,000 characters. You have entered ","Comment text too long"))return!1;u=decodeURIComponent(e);n.find("#txt_comment").val("Write a comment...").trigger("autosize.resize");f={CommentId:0,IsDeleted:!1,Comment:u,CommentedUser:{UserId:r.UserId,FullName:r.FullName,Address:r.Address,ProfileUrl:r.ProfileUrl,ThumbnailUrl:r.ThumbnailUrl},IsEditVisible:!0,IsDeleteVisible:!0};$.ajax({url:"/api/articles-comment/"+window.FRSocial.entityId+"/postcomments",type:"POST",data:f,success:function(){t.populateArticleComments()},error:function(){y()}})}function v(n){var r=i.find(".container-comments").data("loggedin-user-info"),f=n.data("id"),u,e;f&&parseInt(f)>0&&(u=n.closest(".commentBox"),e={CommentId:f,IsDeleted:!0,CommentedUser:{UserId:r.UserId,FullName:r.FullName,Address:r.Address,ProfileUrl:r.ProfileUrl,ThumbnailUrl:r.ThumbnailUrl},IsEditVisible:!0,IsDeleteVisible:!0},$.ajax({url:"/api/articles-comment/"+window.FRSocial.entityId+"/deletecomments",type:"DELETE",data:e,success:function(n){n.IsSuccess?(u.remove(),t.populateArticleComments()):(u.show(),o())},error:function(){u.next(".temp-deleted").remove();u.show();o()}}))}function y(){throw new FRError({className:"FRSocialActivityComment",methodName:"addArticleComment",message:"Failed to Add Comments"});}function e(){throw new FRError({className:"FRSocialActivityComment",methodName:"updateArticleComment",message:"Failed to Edit Comments"});}function o(){throw new FRError({className:"FRSocialActivityComment",methodName:"deleteArticleComment",message:"Failed to Delete Comments"});}function p(){a()}function w(n,t){var i=n.id.split("_"),r=i[1]+"_"+i[2]+"_"+i[3]+"_"+i[4],u;$("#div_"+t).append('<div id="divCommentTemp" style="display:none;">'+$("#div_"+t+" p.mtm3").html()+"<\/div>");$("#div_"+t+" #divCommentTemp a.fontnormal").first().remove();u=nt($("#div_"+t+" #divCommentTemp").html());$("#div_"+t+" #divCommentTemp").remove();var f=$("#div_"+t+" .toolbar  a.btmArrow").length?1:0,e=$("#div_"+t+" p:last").text(),o=$(['<div class="wrapper pt4 pb4 wAuto">','<textarea onfocus="showUserImage(this)" onblur="hideUserImage(this)" id="txtUpdate_'+r+"_"+t+'" style="overflow: hidden;" cols="2" rows="1" class="grey_90 comment-textarea write nrsize frUIResizeTextArea h15a fs11"> ',u+"<\/textarea> ",'<\/div><div class="commentAddWrap"><div>','<a class="addBtnComment" href="javascript:void(0);" data-date="date" onClick="FRSocialActivity.comment.update(this,\''+e+"','"+t+"',"+f+')" id="btnUpdatecom_'+r+'">',"<span>Add<\/span>","<\/a>","<\/div>","<\/div>"].join(""));$("#div_"+t).html(o);$(document).trigger("ui.refresh");$("#txtUpdate_"+r+"_"+t).focus()}function b(n){if(parseInt(window.FRSocial.loginUserId)==0){t.showLoginPopUp();return}if($(n).parent().prev().length)$(n).parent().prev().show();else{var i='<div class="imgTn32" style="display: block;"><img src="'+window.FRSocial.loopUrl+"/images/profile/"+window.FRSocial.loginUserId+'/32" alt="" onerror="if (!this.src.endsWith(\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\'))  this.src=\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\';"><\/div>';$(n).parent().before(i)}$(n).addClass("comment-text-focus");$(n).autosize()}function k(n){$(n).parent().prev().hide();$(n).removeClass("comment-text-focus")}function d(n){if(parseInt(window.FRSocial.loginUserId)==0){t.showLoginPopUp();return}if($(n).parent().prev().length)$(n).parent().prev().show();else{var i='<div class="imgTn32" style="display: block;"><img src="'+window.FRSocial.loopUrl+"/images/profile/"+window.FRSocial.loginUserId+'/32" alt="" onerror="if (!this.src.endsWith(\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\')) this.src=\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\';"><\/div>';$(n).parent().before(i)}$(n).addClass("comment-text-focus");$(n).autosize()}function g(n){if(parseInt(window.FRSocial.loginUserId)==0){t.showLoginPopUp();return}if($(n).parent().prev().length){var i='<div class="imgTn32" style="display: block;"><img src="'+window.FRSocial.loopUrl+"/images/profile/"+window.FRSocial.loginUserId+'/32" alt="" onerror="if (!this.src.endsWith(\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\')) this.src=\'/Areas/Articles/Images/Frontiers/Common/Profile/default_profile_32.jpg\';"><\/div>';$(n).parent().before(i)}$(n).addClass("comment-text-focus");$(n).autosize()}function nt(n){return tt(n.replace(/<br\s*[\/]?>/gi,"\n"))}function tt(n){for(var i=new RegExp("<a[^>]*>(.*?)<\/a>","i"),t;i.test(n);)t=i.exec(n),t!=null&&t.length>1&&(n=n.replace(i,t[1]));return n}function s(n,t,i,r,u,f,e){var o=4e3,s;return n.length>o||r.length>o?(s=n.length>o?n.length:r.length,f=f+s+" characters here.",it(f,e)):n==""&&t==""&&i==""&&r==""&&u==""?!1:!0}function it(n,t){var i=$(".modal.login-modal"),u;if(i.length){i.find(".modal-header h4").text(t);i.find(".modal-body p").text(n);i.modal("show");return}u=$(['<div class="modal login-modal fade" data-backdrop="static">','<div class="modal-dialog">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button>',"<h4>"+t+"<\/h4>","<\/div>",'<div class="modal-body">',"<p>"+n+"<\/p>","<\/div>",'<div class="modal-footer">','<button type="button" class="btn btn-flat btn-close btn-new-orange" data-dismiss="modal">Close<\/button>',"<\/div>","<\/div>","<\/div>","<\/div>"].join(""));r.append(u);r.find(".modal.login-modal").modal("show")}var u=$('<a class="fontnormal btmArrow" href="javascript:void(0);"><span class="upArrow float_right"><\/span><\/a>');return $(function(){h()}),{showUserImage:b,showUserImageOnEdit:g,showUserImageOnAdd:d,hideUserImage:k,addComment:p,editComment:w}}();return{showUserImage:u.showUserImage,showUserImageOnEdit:u.showUserImageOnEdit,showUserImageOnAdd:u.showUserImageOnAdd,hideUserImage:u.hideUserImage,showAllUsersFeedActivityPopup:t.showAllUsersFeedActivityPopup,hideAllUsersFeedActivityPopup:t.hideAllUsersFeedActivityPopup,comment:{add:u.addComment,edit:u.editComment},getFormattedCommentDate:t.getFormattedCommentDate,getFormattedCommentDeletedDate:t.getFormattedCommentDeletedDate}}();inherits(MarkerLabel_,google.maps.OverlayView);MarkerLabel_.getSharedCross=function(n){var t;return typeof MarkerLabel_.getSharedCross.crossDiv=="undefined"&&(t=document.createElement("img"),t.style.cssText="position: absolute; z-index: 1000002; display: none;",t.style.marginLeft="-8px",t.style.marginTop="-9px",t.src=n,MarkerLabel_.getSharedCross.crossDiv=t),MarkerLabel_.getSharedCross.crossDiv};MarkerLabel_.prototype.onAdd=function(){var n=this,r=!1,t=!1,o,s,h,f,i,c,l,u=20,a="url("+this.handCursorURL_+")",e=function(n){n.preventDefault&&n.preventDefault();n.cancelBubble=!0;n.stopPropagation&&n.stopPropagation()},v=function(){n.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_);this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_);typeof MarkerLabel_.getSharedCross.processed=="undefined"&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0);this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(t){(n.marker_.getDraggable()||n.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(n.marker_,"mouseover",t))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(i){(n.marker_.getDraggable()||n.marker_.getClickable())&&!t&&(this.style.cursor=n.marker_.getCursor(),google.maps.event.trigger(n.marker_,"mouseout",i))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(i){t=!1;n.marker_.getDraggable()&&(r=!0,this.style.cursor=a);(n.marker_.getDraggable()||n.marker_.getClickable())&&(google.maps.event.trigger(n.marker_,"mousedown",i),e(i))}),google.maps.event.addDomListener(document,"mouseup",function(e){var s;if(r&&(r=!1,n.eventDiv_.style.cursor="pointer",google.maps.event.trigger(n.marker_,"mouseup",e)),t){if(i){s=n.getProjection().fromLatLngToDivPixel(n.marker_.getPosition());s.y+=u;n.marker_.setPosition(n.getProjection().fromDivPixelToLatLng(s));try{n.marker_.setAnimation(google.maps.Animation.BOUNCE);setTimeout(v,1406)}catch(h){}}n.crossDiv_.style.display="none";n.marker_.setZIndex(o);f=!0;t=!1;e.latLng=n.marker_.getPosition();google.maps.event.trigger(n.marker_,"dragend",e)}}),google.maps.event.addListener(n.marker_.getMap(),"mousemove",function(f){var e;r&&(t?(f.latLng=new google.maps.LatLng(f.latLng.lat()-s,f.latLng.lng()-h),e=n.getProjection().fromLatLngToDivPixel(f.latLng),i&&(n.crossDiv_.style.left=e.x+"px",n.crossDiv_.style.top=e.y+"px",n.crossDiv_.style.display="",e.y-=u),n.marker_.setPosition(n.getProjection().fromDivPixelToLatLng(e)),i&&(n.eventDiv_.style.top=e.y+u+"px"),google.maps.event.trigger(n.marker_,"drag",f)):(s=f.latLng.lat()-n.marker_.getPosition().lat(),h=f.latLng.lng()-n.marker_.getPosition().lng(),o=n.marker_.getZIndex(),c=n.marker_.getPosition(),l=n.marker_.getMap().getCenter(),i=n.marker_.get("raiseOnDrag"),t=!0,n.marker_.setZIndex(1e6),f.latLng=n.marker_.getPosition(),google.maps.event.trigger(n.marker_,"dragstart",f)))}),google.maps.event.addDomListener(document,"keydown",function(r){t&&r.keyCode===27&&(i=!1,n.marker_.setPosition(c),n.marker_.getMap().setCenter(l),google.maps.event.trigger(document,"mouseup",r))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(t){(n.marker_.getDraggable()||n.marker_.getClickable())&&(f?f=!1:(google.maps.event.trigger(n.marker_,"click",t),e(t)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(t){(n.marker_.getDraggable()||n.marker_.getClickable())&&(google.maps.event.trigger(n.marker_,"dblclick",t),e(t))}),google.maps.event.addListener(this.marker_,"dragstart",function(){t||(i=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(){t||i&&(n.setPosition(u),n.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(){t||i&&n.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){n.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){n.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){n.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){n.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){n.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){n.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){n.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){n.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){n.setStyles()})]};MarkerLabel_.prototype.onRemove=function(){var n;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),n=0;n<this.listeners_.length;n++)google.maps.event.removeListener(this.listeners_[n])};MarkerLabel_.prototype.draw=function(){this.setContent();this.setTitle();this.setStyles()};MarkerLabel_.prototype.setContent=function(){var n=this.marker_.get("labelContent");typeof n.nodeType=="undefined"?(this.labelDiv_.innerHTML=n,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(n),n=n.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(n))};MarkerLabel_.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""};MarkerLabel_.prototype.setStyles=function(){var n,t;this.labelDiv_.className=this.marker_.get("labelClass");this.eventDiv_.className=this.labelDiv_.className;this.labelDiv_.style.cssText="";this.eventDiv_.style.cssText="";t=this.marker_.get("labelStyle");for(n in t)t.hasOwnProperty(n)&&(this.labelDiv_.style[n]=t[n],this.eventDiv_.style[n]=t[n]);this.setMandatoryStyles()};MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute";this.labelDiv_.style.overflow="hidden";typeof this.labelDiv_.style.opacity!="undefined"&&this.labelDiv_.style.opacity!==""&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+this.labelDiv_.style.opacity*100+')"',this.labelDiv_.style.filter="alpha(opacity="+this.labelDiv_.style.opacity*100+")");this.eventDiv_.style.position=this.labelDiv_.style.position;this.eventDiv_.style.overflow=this.labelDiv_.style.overflow;this.eventDiv_.style.opacity=.01;this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"';this.eventDiv_.style.filter="alpha(opacity=1)";this.setAnchor();this.setPosition();this.setVisible()};MarkerLabel_.prototype.setAnchor=function(){var n=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-n.x+"px";this.labelDiv_.style.marginTop=-n.y+"px";this.eventDiv_.style.marginLeft=-n.x+"px";this.eventDiv_.style.marginTop=-n.y+"px"};MarkerLabel_.prototype.setPosition=function(n){var t=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());typeof n=="undefined"&&(n=0);this.labelDiv_.style.left=Math.round(t.x)+"px";this.labelDiv_.style.top=Math.round(t.y-n)+"px";this.eventDiv_.style.left=this.labelDiv_.style.left;this.eventDiv_.style.top=this.labelDiv_.style.top;this.setZIndex()};MarkerLabel_.prototype.setZIndex=function(){var n=this.marker_.get("labelInBackground")?-1:1;typeof this.marker_.getZIndex()=="undefined"?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+n,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+n,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)};MarkerLabel_.prototype.setVisible=function(){this.labelDiv_.style.display=this.marker_.get("labelVisible")?this.marker_.getVisible()?"block":"none":"none";this.eventDiv_.style.display=this.labelDiv_.style.display};inherits(MarkerWithLabel,google.maps.Marker);MarkerWithLabel.prototype.setMap=function(n){google.maps.Marker.prototype.setMap.apply(this,arguments);this.label.setMap(n)};FRNetworkUserFollow=function(){function h(){if(window.FRSocial.loginUserId==0)n.find(".btn-journal-follow").removeClass("loop-hide"),n.find(".btn-journal-follow").html('Follow<span class="hidden-sm hidden-xs"> on Loop<\/span>');else{var t;t=window.FRJournalDetails.JournalType=="journal"?{journalId:window.FRJournalDetails.JournalId}:{journalId:window.FRJournalDetails.SectionId};$.ajax({url:"/proxy/Follow/followjournalstatus",data:t,type:"POST",traditional:!0,dataType:"json",success:function(n){a(n)}})}}function c(){if(window.FRSocial.loginUserId==0)n.find(".teaser-follow button").map(function(){$(this).data("userId")>0&&$(this).addClass("btn-follow-orange").text("Follow").removeClass("follow-hide")});else{var t={userId:l()};$.ajax({url:"/proxy/Follow/FollowStatus",data:t,type:"POST",traditional:!0,dataType:"json",success:function(n){v(n)}})}}function l(){var t=[];return n.find(".follow-button[data-user-id]").each(function(n,i){t.push(parseInt($(i).data("userId")))}),_.uniq(t)}function a(t){t!=0?(n.find(".btn-journal-follow").html("Following"),n.find(".btn-journal-follow").addClass("following")):n.find(".btn-journal-follow").html('Follow<span class="hidden-sm hidden-xs"> on Loop<\/span>');n.find(".btn-journal-follow").removeClass("loop-hide")}function v(t){if(t!=null){if(t.LoggedInUserID==0&&n.find(".teaser-follow button").map(function(){$(this).data("userId")>0&&$(this).addClass("btn-follow-orange").text("Follow").removeClass("follow-hide")}),!t.FollowList||!t.FollowList.length)return;$(t.FollowList).each(function(t,i){if(i.UserId>0){var u=n.find(".follow"),r=u.find(".follow-button[data-user-id="+i.UserId+"]");i.IsFollowButtonVisible?(i.IsBlocked?r.addClass("btn-follow-blocked").removeClass("btn-follow-orange").text("Blocked"):i.IsFollowing?r.text("Following").addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-widget-follow"):i.IsBlockingMe?r.addClass("btn-follow-blockingme btn-follow-orange").text("Follow"):r.text("Follow").addClass("btn-follow-orange"),r.removeAttr("data-user-id").removeClass("follow-hide")):r.removeAttr("data-user-id")}})}}function y(){n.on("click",".follow-button",function(){var n=$(this);if(n.hasClass("follow-editor-overview"),window.FRSocial.loginUserId==0)return r(),!1;if(n.hasClass("btn-unfollow")||n.hasClass("btn-follow-grey")){if(n.checkDuplicateEvent())return;window.location.hash===""&&n.removeClass("editorial-board-widget-unfollow").addClass("editorial-board-widget-follow").text("Follow");window.location.hash==="#editorial-board"&&n.removeClass("editorial-board-unfollow").addClass("editorial-board-follow").text("Follow");n.removeClass("btn-follow-grey btn-unfollow").addClass("btn-follow-orange").text("Follow");p(n)}else if(n.hasClass("btn-follow-blockingme"))s();else if(n.hasClass("btn-follow-orange")){if(n.checkDuplicateEvent())return;n.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-follow").text("Following");b(n)}else if(n.hasClass("btn-follow-blocked"))return});n.on("mouseenter",".btn-follow-grey",function(){var n=$(this);window.location.hash===""&&n.addClass("editorial-board-widget-unfollow").text("Unfollow");window.location.hash==="#editorial-board"&&n.addClass("editorial-board-unfollow").text("Unfollow");n.addClass("btn-unfollow").removeClass("btn-follow-grey editorial-board-widget-follow editorial-board-follow").text("Unfollow")});n.on("mouseleave",".btn-unfollow",function(){var n=$(this);n.addClass("btn-follow-grey").removeClass("btn-follow-orange btn-unfollow editorial-board-unfollow editorial-board-widget-unfollow ").text("Following")});n.on("click",".btn-journal-follow",function(){if(window.FRSocial.loginUserId==0)return r(),!1;var t,i=$(this);if(n.find(".btn-journal-follow").hasClass("following")){if(i.checkDuplicateEvent())return;window.FRJournalDetails.JournalType=="journal"?(t={journalId:window.FRJournalDetails.JournalId},tt(t)):(t={sectionId:window.FRJournalDetails.SectionId},it(t))}else{if(i.checkDuplicateEvent())return;window.FRJournalDetails.JournalType=="journal"?(t={journalId:window.FRJournalDetails.JournalId},g(t)):(t={sectionId:window.FRJournalDetails.SectionId},nt(t))}});n.on("mouseenter",".btn-journal-follow.following",function(){var n=$(this);n.text("Unfollow").addClass("btn-loop-unfollow")});n.on("mouseleave",".btn-journal-follow.following",function(){var n=$(this);n.text("Following").removeClass("btn-loop-unfollow editorial-board-widget-unfollow")})}function p(n){var t=n.data("userId");o(t,n,"unfollow",w)}function w(t,u){var f,o;if(t!=null&&t.LoggedInUserID==0){r();return}if(t!=null&&t.FollowList!=null&&t.FollowList.length>0){if(f=n.find(".teaser-follow button").map(function(){if($(this).data("userId")==t.FollowList[0].UserId)return this}),t.FollowList[0].IsBlockingMe||t.FollowList[0].IsBlocked){f.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-widget-follow").text("Following");i();return}o={userId:t.FollowList[0].UserId};$.ajax({url:"/proxy/Follow/UnFollow",type:"POST",data:o,success:function(){f.addClass("btn-follow-orange").removeClass("btn-follow-grey").text("Follow");f.checkDuplicateEvent("clear")},error:function(){f.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-widget-follow").text("Following");e();f.checkDuplicateEvent("clear")}})}else u.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-widget-follow").text("Following"),e()}function b(n){var t=n.data("userId");o(t,n,"follow",k)}function k(t,u){var f,e;if(t!=null&&t.LoggedInUserID==0){r();return}if(t!=null&&t.FollowList!=null&&t.FollowList.length>0){if(f=n.find(".teaser-follow button").map(function(){if($(this).data("userId")==t.FollowList[0].UserId)return this}),t.FollowList[0].IsBlocked){f.addClass("btn-follow-orange").removeClass("btn-follow-grey").text("Follow");i();return}if(t.FollowList[0].IsBlockingMe){f.addClass("btn-follow-orange").removeClass("btn-follow-grey").text("Follow");s();return}e={userId:t.FollowList[0].UserId};$.ajax({url:"/proxy/Follow/Follow",type:"POST",data:e,success:function(){f.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-widget-follow").text("Following");f.checkDuplicateEvent("clear")},error:function(){f.addClass("btn-follow-orange").removeClass("btn-follow-grey").text("Follow");i();f.checkDuplicateEvent("clear")}})}else u.addClass("btn-follow-orange").removeClass("btn-follow-grey").text("Follow"),i()}function o(n,t,i,r){var u={userId:n};$.ajax({url:"/proxy/Follow/FollowStatus",data:u,type:"POST",traditional:!0,dataType:"json",success:function(n){return r(n,t)},error:function(){d(i,t)}})}function d(n,t){n=="follow"?(t.addClass("btn-follow-orange editorial-board-widget-follow").removeClass("btn-follow-grey").text("Follow"),i()):n=="unfollow"&&(t.addClass("btn-follow-grey").removeClass("btn-follow-orange editorial-board-follow editorial-board-widget-follow").text("Following"),e())}function e(){throw new FRError({className:"FRNetworkUserFollow",methodName:"Follow",message:"Failed to UnFollow"});}function i(){throw new FRError({className:"FRNetworkUserFollow",methodName:"Follow",message:"Failed to Follow"});}function r(){if($(".modal.login-modal").length){$(".modal.login-modal").modal("show");return}var t=window.FRConfiguration.SharepointWebsiteUrl+"/Login.aspx?returnurl="+document.location.href,i=$(['<div class="modal login-modal fade" data-backdrop="static">','<div class="modal-dialog">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button>',"<h4>Login Required<\/h4>","<\/div>",'<div class="modal-body">',"<p>This action requires you to be registered with Frontiers and logged in. To register or login click <a href="+t+">here.<\/a> <\/p>","<\/div>",'<div class="modal-footer">','<button type="button" class="btn btn-flat btn-close btn-new-orange" data-dismiss="modal">Close<\/button>',"<\/div>","<\/div>","<\/div>","<\/div>"].join(""));n.append(i);n.find(".modal.login-modal").modal("show")}function s(){$.FRModal({modalClass:"popup-block",contentHeader:$("<h3>Network<\/h3>"),contentBody:$("<p> This person cannot be followed. <\/p>")})}function g(i){var r=n.find(".btn-journal-follow").text();u("True");$.ajax({url:"/proxy/follow/followjournal",type:"POST",data:i,success:function(n){n!="True"&&(u(n),t(r))},error:function(){t(r)}})}function nt(i){var r=n.find(".btn-journal-follow").text();u("True");$.ajax({url:"/proxy/follow/followsection",type:"POST",data:i,success:function(n){n!="True"&&(u(n),t(r))},error:function(){t(r)}})}function u(t){t!="True"?(n.find(".btn-journal-follow").removeClass("following"),n.find(".btn-journal-follow").html('Follow<span class="hidden-sm hidden-xs"> on Loop<\/span>'),n.find(".btn-journal-follow").checkDuplicateEvent("clear")):(n.find(".btn-journal-follow").text("Following"),n.find(".btn-journal-follow").addClass("following"),n.find(".btn-journal-follow").checkDuplicateEvent("clear"))}function tt(i){var r=n.find(".btn-journal-follow").text();f("True");$.ajax({url:"/proxy/follow/unfollowjournal",type:"POST",data:i,success:function(n){n!="True"&&(f(n),t(r))},error:function(){t(r)}})}function it(i){var r=n.find(".btn-journal-follow").text();f("True");$.ajax({url:"/proxy/follow/unfollowsection",type:"POST",data:i,success:function(n){n!="True"&&(f(n),t(r))},error:function(){t(r)}})}function f(t){t!="True"?(n.find(".btn-journal-follow").text("Following"),n.find(".btn-journal-follow").addClass("following"),n.find(".btn-journal-follow").checkDuplicateEvent("clear")):(n.find(".btn-journal-follow").removeClass("following").removeClass("btn-loop-unfollow"),n.find(".btn-journal-follow").html('Follow<span class="hidden-sm hidden-xs"> on Loop<\/span>'),n.find(".btn-journal-follow").checkDuplicateEvent("clear"))}function t(n){n=="Follow on Loop"?ut():n=="Following"&&rt()}function rt(){throw new FRError({className:"FRNetworkUserFollowJournal",methodName:"Follow",message:"Failed to UnFollow Journal"});}function ut(){throw new FRError({className:"FRNetworkUserFollowJournal",methodName:"Follow",message:"Failed to Follow Journal"});}var n=$(".page-container");return $(function(){y()}),typeof $.fn.checkDuplicateEvent=="undefined"&&function(n){var t={check:function(){var n=this.first();return n.data("disabled")?!0:(n.data("disabled",!0),!1)},clear:function(){return this.data("disabled",!1)}};n.fn.checkDuplicateEvent=function(n){return t[n]?t[n].apply(this):t.check.apply(this)}}(jQuery),{fillUserFollow:c,fillJournalFollow:h}}()